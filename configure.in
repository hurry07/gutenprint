dnl Process this file with autoconf to produce a configure script.
AC_INIT(print.c)
AM_INIT_AUTOMAKE(print,4.0a3)

dnl Checks for programs.
AC_PROG_AWK
AC_PROG_CC
AC_PROG_INSTALL
AC_PROG_LN_S
AC_PROG_YACC
AM_PROG_LEX
AC_PATH_PROG(BISON_PROG, bison)
AC_PATH_PROG(YACC_PROG, yacc)

RELDATE_DEF="-DRELEASE_DATE=\"\\\"`date '+%d %b %Y'`\\\"\""

AM_MAINTAINER_MODE

if test "$USE_MAINTAINER_MODE" = "yes" ; then
  MAINTAINER_PROGRAMS='escp2-weavetest printer_options'
else
  MAINTAINER_PROGRAMS=''
fi

dnl MRS: Only GCC supports -Wall and other GCC options...

if test -n "$GCC"; then
  if test "$USE_MAINTAINER_MODE" = "yes" ; then
    MAINTAINER_CFLAGS='-Wall -Wcast-align -Wstrict-prototypes -DGIMP_PRINT_MAINT'
  else
    MAINTAINER_CFLAGS='-Wall'
  fi
else
  if test "$USE_MAINTAINER_MODE" = "yes" ; then
    MAINTAINER_CFLAGS='-DGIMP_PRINT_MAINT'
  else
    MAINTAINER_CFLAGS=''
  fi
fi

AM_PATH_GIMP(1.0.0,
        [SAVE_GTK_LIBS="$GIMP_LIBS"
        SAVE_GTK_CFLAGS="$GIMP_CFLAGS"],
        AC_MSG_ERROR(Cannot find GIMP libs: Please run ldconfig as root, and make sure gimptool is on your PATH.))

dnl Checks for libraries.
dnl Checking for the Gimp does all this

dnl Checks for header files.
AC_HEADER_STDC
AC_CHECK_HEADERS(unistd.h)

dnl Checks for typedefs, structures, and compiler characteristics.
AC_C_CONST
AC_TYPE_OFF_T
AC_TYPE_SIZE_T

dnl Checks for library functions.
AC_FUNC_MEMCMP
AC_TYPE_SIGNAL

AC_SUBST(GIMP_LIBS)
AC_SUBST(RELDATE_DEF)
AC_SUBST(MAINTAINER_PROGRAMS)
AC_SUBST(MAINTAINER_CFLAGS)

AC_OUTPUT(Makefile)
